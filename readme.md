# Malware detection with MaxViT transformer
Detect PE malicious file with Multi-Axis Vision Transformer (MaxViT model)

## Getting started
### clone repo
    git clone https://github.com/prozip/malware-detection_MaxViT-Transformer
### Prepare data
- Modify location path in config/train_config.yml
- Dataset contains folders with name as label
### Train
    python3 train.py -t S
    python3 train.py -t S -b 64
### Parameters
- edit para in config/*.yml

## Architecture
### 1. Convert PE file to color image
    python2 bin2rgb.py
- PE file -> entropy (Shannon)
- entropy -> rgb color (Binvis)
- rgb color -> image (Hilbert curve)<br>
### 2. MaxViT: Multi-Axis Vision Transformer
- MaxT-0 (31M): S1 hidden_size 64; num_blocks [2, 2, 5, 2]
- MaxT-1 (69M): S1 hidden_size 96; num_blocks [2, 2, 5, 2]
- MaxT-2 (119M): S1 hidden_size 96; num_blocks [2, 6, 14, 2]
- MaxT-3 (212M): S1 hidden_size 128; num_blocks [2, 6, 14, 2]
- MaxT-4 (476M): S1 hidden_size 192; num_blocks [2, 6, 14, 2]
![MaxViT architecture](/images/maxvit.png)

## Dataset color image samples
### DikeDataset

|                            Benign                            |                          Malicious                           |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
| <img src="file:///images/benign/0a8deb24eef193e13c691190758c349776eab1cd65fba7b5dae77c7ee9fcc906.png?lastModify=1657427277" style="zoom:80%;" /> | <img src="file:///images/benign/0a464a3765ffc0c23cf47345bf1185426af8e6b5711e015ca18027afcac2f2e0.png?lastModify=1657427277" style="zoom:80%;" /> |

### 